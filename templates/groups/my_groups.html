{% extends 'base.html' %}

{% block title %}My Groups | Secret Santa{% endblock %}
{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-white mb-0"><i class="fas fa-users me-2"></i>My Santa Groups</h2>
        <div>
            <a href="{% url 'groups:create' %}" class="btn btn-santa me-2"><i class="fas fa-plus me-1"></i> New</a>
            <a href="{% url 'groups:join' %}" class="btn btn-outline-light"><i class="fas fa-ticket-alt me-1"></i> Join</a>
        </div>
    </div>

    {% if hosted_groups or memberships %}
    <div class="row g-4">
        {% for group in hosted_groups %}
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">{{ group.name }}</h5>
                    <span class="badge bg-warning text-dark"><i class="fas fa-crown me-1"></i>Host</span>
                </div>
                <p class="text-muted small mb-3">{{ group.members.count }} participant{{ group.members.count|pluralize }}</p>
                <div class="mb-3">
                    {% if group.matching_done %}
                    <span class="status-badge status-matched"><i class="fas fa-check-circle me-1"></i>Matched!</span>
                    {% else %}
                    <span class="status-badge status-pending"><i class="fas fa-clock me-1"></i>Awaiting Match</span>
                    {% endif %}
                </div>
                <a href="{% url 'groups:detail' group.invite_code %}" class="btn btn-santa w-100 mt-auto">
                    Open Group
                </a>
            </div>
        </div>
        {% endfor %}
        
        {% for membership in memberships %}
        {% if membership.group.host != request.user %}
        <div class="col-md-6 col-lg-4">
            <div class="card h-100 p-4">
                <h5 class="mb-1">{{ membership.group.name }}</h5>
                <p class="text-muted small mb-3">Hosted by {{ membership.group.host.first_name|default:membership.group.host.username }}</p>
                <div class="mb-3">
                    {% if membership.group.matching_done %}
                    <span class="status-badge status-matched"><i class="fas fa-check-circle me-1"></i>Matched!</span>
                    {% else %}
                    <span class="status-badge status-pending"><i class="fas fa-clock me-1"></i>Awaiting Match</span>
                    {% endif %}
                </div>
                <a href="{% url 'groups:detail' membership.group.invite_code %}" class="btn btn-outline-santa w-100 mt-auto">
                    View Group
                </a>
            </div>
        </div>
        {% endif %}
        {% endfor %}
    </div>
    {% else %}
    <div class="card p-5 text-center">
        <i class="fas fa-gifts fa-4x mb-4" style="color:#ccc;"></i>
        <h4>No groups yet!</h4>
        <p class="text-muted mb-4">Create your first Secret Santa group or join one with an invite code.</p>
        <div>
            <a href="{% url 'groups:create' %}" class="btn btn-santa me-2">Create Group</a>
            <a href="{% url 'groups:join' %}" class="btn btn-outline-santa">Join Group</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}